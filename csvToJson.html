<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>수요조사 결과</title>
    <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="./FileSaver.min.js"></script>
    <script type="text/javascript">
      $.get("./newSeedStation.csv",function(data){
        var stations = data.split("\n");
        console.log("정류장 개수 : " + stations.length);

        var resultArray = [];

        stations.forEach(function(element) {
          var row = element.split(",");
          var passRouteArray = [];
          var passRoute = row[8].split("&");
          passRoute.forEach(function(element){
            passRouteArray.push({'name' : element});
          });

          var rowToJson = {
            'type' : row[0],
            'name' : row[1],
            'location' : {
              '__type' : 'GeoPoint',
              'latitude' : parseFloat(row[3]),
              'longitude' : parseFloat(row[4])
            },
            'mobileNumber' : parseInt(row[5]),
            'stationId' : parseInt(row[6]),
            'region' : row[7],
            'passRoute' : passRouteArray,
            'alight' : parseInt(row[9]),
            'ride' : parseInt(row[10])
          }

          resultArray.push(rowToJson);
        });

        var BOM = "\uFEFF";
        var jsonData = BOM + '{ "results": ' + JSON.stringify(resultArray) + '}';
        var blob = new Blob([jsonData], { type: "text/json;charset=utf-8" });
        saveAs(blob, "newSeedStation.json");
      }); 
    </script>
  </head>
  <body>
  </body>
</html>